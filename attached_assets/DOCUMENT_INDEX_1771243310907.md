# Dakkah CityOS — Master Document Index

**Version:** 1.0
**Date:** February 13, 2026
**Purpose:** Complete catalog of all planning, design, implementation, and reference documents for the CityOS platform.

---

## Document Categories

| Category | Count | Purpose |
|----------|-------|---------|
| [Architecture & Design](#1-architecture--design-documents) | 8 | System design, data models, patterns, architecture decisions |
| [AI & Intelligence](#2-ai--intelligence-documents) | 3 | AI Page Builder, intelligence layer, AI/ML system |
| [Implementation & Roadmaps](#3-implementation--roadmap-documents) | 4 | Build plans, phase schedules, checklists |
| [Domain & Block References](#4-domain--block-reference-documents) | 4 | Domain packages, block catalogs, QA reports |
| [Platform Guides](#5-platform-guide-documents) | 2 | End-to-end platform reference, routes/roles |
| [Workflow & Integration](#6-workflow--integration-documents) | 3 | Workflow alignment, external integrations, storage gateway |
| [Assessment & Analysis](#7-assessment--analysis-documents) | 1 | Platform health, gap analysis, readiness evaluation |
| [Project Memory](#8-project-memory) | 1 | Living project reference (replit.md) |
| **Total** | **26** | |

**Note:** Files marked with `(root)` are in the project root directory. All others are in the `docs/` directory.

---

## 1. Architecture & Design Documents

### 1.1 Platform Bible
- **File:** `docs/DAKKAH_CITYOS_PLATFORM_BIBLE.md`
- **Purpose:** Foundational architecture document — the "constitution" of CityOS. Covers multi-tenancy model, hierarchical design patterns, RBAC system, data classification, residency zones, governance structures, and platform philosophy.
- **Audience:** Platform architects, senior engineers, technical leadership
- **Key Topics:** Tenant tier hierarchy, node system, interlocking hierarchies (7 types), plugin registry, data sovereignty

### 1.2 Hierarchical Design Patterns
- **File:** `docs/HIERARCHICAL_DESIGN_PATTERNS.md`
- **Purpose:** Deep dive into the 7 interlocking hierarchies that govern CityOS — Nodes, Tenant Tiers, Governance Levels, Data Classification, Residency Zones, RBAC, and Persona System.
- **Audience:** Backend engineers, data architects
- **Key Topics:** Node hierarchy (6 tiers), tenant inheritance, governance level resolution, data classification enforcement, residency zone compliance

### 1.3 Domain Package Architecture
- **File:** `docs/DOMAIN_PACKAGE_ARCHITECTURE.md`
- **Purpose:** Complete specification of the modular domain package system — how the 37 domains are structured, registered, activated, and integrated.
- **Audience:** Domain developers, frontend architects
- **Key Topics:** DomainPackage interface, manifest structure, block registration, component resolution, tenant activation rules, theme token system

### 1.4 POI System Deep Dive
- **File:** `docs/POI_SYSTEM_DEEP_DIVE.md`
- **Purpose:** Complete specification of the POI (Point of Interest) spatial identity engine — the canonical geo truth layer.
- **Audience:** Backend engineers, GIS specialists, spatial data architects
- **Key Topics:** POI Constitution, recursive 6-tier hierarchy, 32 POI types, capability engine (29 codes), H3/geohash indexing, workflow infrastructure (80 workflows, 14 queues)

### 1.5 POI System Reference
- **File:** `docs/poi-system.md`
- **Purpose:** Quick-reference companion to the POI Deep Dive — focused on practical usage patterns and API interactions.
- **Audience:** Frontend and backend engineers working with POI data
- **Key Topics:** POI CRUD operations, proximity search, capability resolution, workflow triggers

### 1.6 Persona System
- **File:** `docs/persona-system.md`
- **Purpose:** Multi-axis persona system design — how CityOS identifies and serves different user types.
- **Audience:** Product designers, frontend engineers, RBAC implementers
- **Key Topics:** Persona axes, role-persona mapping, personalized content delivery, persona-based block visibility

### 1.7 Capability Ownership Matrix
- **File:** `docs/capability-ownership-matrix.md`
- **Purpose:** Maps every system capability to its owning domain, collection, and responsible role.
- **Audience:** Project managers, domain leads, integration engineers
- **Key Topics:** Capability codes, ownership assignments, cross-domain dependencies

### 1.8 Roadmap (Legacy)
- **File:** `docs/roadmap.md`
- **Purpose:** Earlier-version high-level roadmap. Superseded by IMPLEMENTATION_ROADMAP.md for detailed phasing.
- **Audience:** Historical reference
- **Status:** Superseded — use IMPLEMENTATION_ROADMAP.md instead

---

## 2. AI & Intelligence Documents

### 2.1 AI Page Builder (NEW)
- **File:** `docs/AI_PAGE_BUILDER.md`
- **Purpose:** Complete deep-dive specification of the AI-Powered Page Builder — the flagship AI feature of CityOS. Covers the full composition pipeline (prompt → intent parsing → vector search → block selection → content generation → SEO → audit → page JSON), block manifest system, template learning, feedback loops, admin UI, API reference, cost management, error handling, and implementation phases.
- **Audience:** Full engineering team, product managers, platform architects
- **Key Topics:**
  - 8-step composition pipeline with timing budgets
  - Block Manifest System (1,348 blocks × 20+ metadata fields × vector embedding)
  - Intent parsing engine with GPT-4o structured output
  - Vector search with pgvector (HNSW indexing, pre-filtering strategies)
  - Template matching and AI-learned template discovery
  - Content generation engine with tone adaptation and multilingual output
  - Layout optimization using engagement data and UX best practices
  - SEO auto-generation (meta tags, JSON-LD, OpenGraph, hreflang)
  - Translation engine with domain-specific terminology glossaries
  - Image/media intelligence (stock suggestions, DALL-E generation, alt-text)
  - Accessibility auditing (WCAG 2.1 AA with auto-fix)
  - Content governance (brand consistency, policy compliance)
  - Feedback and learning system (session tracking, quality improvement)
  - Admin UI wireframe specification (20 AI blocks)
  - Full API reference (30+ endpoints across 5 route groups)
  - Data collections and schema (6 collections, 10+ indexes)
  - Embedding pipeline (auto-embed hooks, batch seeding, cost tracking)
  - Security and RBAC (role matrix, tenant isolation, rate limiting)
  - Cost management ($0.032 per page composition breakdown)
  - Error handling and 4-level graceful degradation
  - Performance targets and caching strategy
  - Testing strategy with quality benchmarks
  - 4-phase implementation plan (18 weeks)
- **Dependencies:** AI_DOMAIN_DESIGN.md, BLOCK_USE_CASES.md, ROUTES_AND_ROLES.md

### 2.2 AI Domain Design
- **File:** `docs/AI_DOMAIN_DESIGN.md`
- **Purpose:** Comprehensive AI intelligence layer design — covers all 10 AI capabilities, pgvector architecture, PostGIS integration, domain-level vectorization for all 37 domains, expanded ai-ml domain (50 blocks), and cross-domain AI (18 blocks).
- **Audience:** AI engineers, backend architects, data engineers
- **Key Topics:**
  - BlockManifests collection schema (pgvector)
  - PageTemplates collection schema (pgvector)
  - AIPageSessions and AIContentGenerations collections
  - 10 AI capabilities with full API specs
  - Domain-level vectorization (37 DomainVectors tables)
  - PostGIS integration for 16 spatial domains
  - Embedding pipeline architecture
  - Security and governance
  - Implementation phases (10 steps)
- **Dependencies:** BLOCK_USE_CASES.md, IMPLEMENTATION_ROADMAP.md

### 2.3 AI/ML System Reference
- **File:** `docs/AI_ML_SYSTEM.md`
- **Purpose:** Reference for the existing AI management system — AIPrompts, AIResponses, execute/playground APIs, admin views, cost tracking.
- **Audience:** Engineers working with the existing AI infrastructure
- **Key Topics:** Prompt management, response tracking, model configuration, cost calculation

---

## 3. Implementation & Roadmap Documents

### 3.1 Implementation Roadmap v2.1
- **File:** `IMPLEMENTATION_ROADMAP.md` **(root)**
- **Purpose:** Master phased implementation plan for the entire 1,348-block platform build. 5 phases (0-4) over 24-34 weeks with AI Intelligence Layer integrated into every phase.
- **Audience:** Project managers, engineering leads, stakeholders
- **Key Topics:**
  - Phase 0: Foundation (registry consolidation, SCSS decomposition, LIVE block validation)
  - Phase 0.5: AI Foundation (pgvector, PostGIS, BlockManifests, seeding)
  - Phase 1: Core domains + AI Content Intelligence (322 blocks)
  - Phase 2: Expansion + Domain Vectorization (378 blocks)
  - Phase 3: Engagement + AI Learning (396 blocks)
  - Phase 4: Premium + Premium AI (252 blocks)
  - AI System Growth table (per-phase additions)
  - Cross-cutting concerns (design system, collections, testing)
  - 7-step block build process (including MANIFEST step)
  - Acceptance gates per phase
- **Dependencies:** BLOCK_USE_CASES.md, AI_DOMAIN_DESIGN.md

### 3.2 Implementation Plan (Checklist)
- **File:** `docs/IMPLEMENTATION_PLAN.md`
- **Purpose:** Detailed implementation checklist with status tracking — organized by gap category with specific action items and checkboxes.
- **Audience:** Engineering team, sprint planners
- **Key Topics:**
  - Infrastructure health assessment (13 systems)
  - Gap analysis (collections, APIs, integrations, security, storage)
  - Phase 2.5: AI Intelligence Layer setup (pgvector, PostGIS, 4 collections, embedding pipeline)
  - Master checklist (100+ items)
  - Risk register (15+ risks with mitigation)
- **Dependencies:** ASSESSMENT.md, IMPLEMENTATION_ROADMAP.md

### 3.3 Full Implementation Plan
- **File:** `docs/FULL_IMPLEMENTATION_PLAN.md`
- **Purpose:** Expanded version of the implementation plan with additional detail on specific subsystems.
- **Audience:** Engineering team
- **Key Topics:** Detailed build steps, dependency chains, testing requirements

### 3.4 Workflow Alignment Roadmap
- **File:** `docs/WORKFLOW_ALIGNMENT_ROADMAP.md`
- **Purpose:** Alignment plan between CityOS and the external Workflow Orchestration Service (Temporal).
- **Audience:** Integration engineers, workflow developers
- **Key Topics:** Workflow definitions, event-to-workflow mapping, task queue configuration, cron triggers

---

## 4. Domain & Block Reference Documents

### 4.1 Block Use Cases Catalog
- **File:** `BLOCK_USE_CASES.md` **(root)**
- **Purpose:** Complete catalog of all 1,348 block use cases across 37 domains + shared platform + cross-domain AI. Lists every block with status (LIVE/NEW), description, and domain assignment.
- **Audience:** Domain developers, product managers, AI manifest seeders
- **Key Topics:**
  - 112 LIVE blocks (existing, validated)
  - 1,236 NEW blocks (to be built across Phases 1-4)
  - Organized by domain with subtotals
  - Grand Summary with tier breakdown
  - Implementation Priority Matrix (by phase)
  - ai-ml domain: 50 blocks (2 LIVE + 48 NEW)
  - Cross-Domain AI: 18 blocks (0 LIVE + 18 NEW)
- **Dependencies:** IMPLEMENTATION_ROADMAP.md

### 4.2 Domain Package QA Report
- **File:** `docs/DOMAIN_PACKAGE_QA_REPORT.md`
- **Purpose:** Quality assurance report for the domain package system — validation of all 37 domain manifests, block registrations, and activation rules.
- **Audience:** QA engineers, domain leads
- **Key Topics:** Manifest validation, block registration verification, activation chain testing

### 4.3 Domain Package Remaining Implementation
- **File:** `docs/DOMAIN_PACKAGE_REMAINING_IMPLEMENTATION.md`
- **Purpose:** Tracks remaining work items for completing the domain package system.
- **Audience:** Engineering team, sprint planners
- **Key Topics:** Outstanding tasks per domain, priority ordering, dependency tracking

### 4.4 Commerce Team Design Note
- **File:** `docs/COMMERCE_TEAM_DESIGN_NOTE.md`
- **Purpose:** Design notes for the commerce domain integration (Medusa-backed).
- **Audience:** Commerce integration engineers
- **Key Topics:** Medusa client integration, product catalog, payment flow, commerce blocks

---

## 5. Platform Guide Documents

### 5.1 Platform Guide
- **File:** `docs/DAKKAH_CITYOS_PLATFORM_GUIDE.md`
- **Purpose:** End-to-end platform reference guide written in plain language. Covers every aspect of CityOS from architecture to admin usage. Includes AI Intelligence Layer, Vector Database, and PostGIS chapters.
- **Audience:** City administrators, onboarding engineers, product managers, non-technical stakeholders
- **Key Topics:**
  - System architecture overview
  - Multi-tenancy and tenant management
  - Domain packages and activation
  - Content management (pages, blocks, media)
  - RBAC and user management
  - Localization (en/fr/ar)
  - Theme system and design presets
  - POI system and spatial features
  - AI Intelligence Layer (10 capabilities explained in plain language)
  - Vector Database (pgvector) explanation with analogies
  - PostGIS spatial brain (16 domains, query examples)
  - AI admin tools (6 admin interfaces)
  - AI feature access by role (RBAC matrix)
  - Storage architecture
  - Workflow integration
- **Dependencies:** All architecture and design documents

### 5.2 Routes and Roles Reference
- **File:** `docs/ROUTES_AND_ROLES.md`
- **Purpose:** Complete URL architecture, route inventory, role definitions, and access matrix. Includes 120+ API endpoints covering AI Page Builder, Vector, and Spatial routes.
- **Audience:** Frontend engineers, security reviewers, API consumers
- **Key Topics:**
  - Three-tier URL architecture (public, admin, platform)
  - 11 RBAC roles with permission tiers
  - Content Manager pages (31 pages)
  - Platform Admin pages (50 pages)
  - Payload CMS routes
  - API route groups:
    - BFF Layer
    - Auth
    - AI (execute, playground, prompts)
    - AI Page Builder (7 endpoints)
    - AI Content (4 endpoints)
    - AI Audit (3 endpoints)
    - Vector Search (7 endpoints)
    - Spatial/PostGIS (5 endpoints)
    - Commerce, Workflows, Storage, Sync, Platform
  - Role-to-Route access matrix
  - Domain packages to admin group mapping
  - Middleware RBAC enforcement
- **Dependencies:** DAKKAH_CITYOS_PLATFORM_BIBLE.md

---

## 6. Workflow & Integration Documents

### 6.1 Workflow Team Design Note
- **File:** `docs/WORKFLOW_TEAM_DESIGN_NOTE.md`
- **Purpose:** Design notes for the workflow orchestration integration (Temporal-backed).
- **Audience:** Workflow integration engineers
- **Key Topics:** Temporal client, workflow definitions, task queues, event dispatch

### 6.2 Workflow Alignment Roadmap
- **File:** `docs/WORKFLOW_ALIGNMENT_ROADMAP.md`
- **Purpose:** Alignment plan between CityOS internal processes and external workflow service.
- **Audience:** Integration engineers
- **Key Topics:** Event-to-workflow mapping, schedule triggers, BFF API endpoints

### 6.3 Storage Systems & Gateway
- **File:** `docs/STORAGE_GATEWAY.md`
- **Purpose:** Complete reference for the centralized object storage architecture, storage gateway REST API, external system integration guides, media management, and thumbnail strategy. Includes full URL paths for development and production environments.
- **Audience:** Integration engineers, DevOps, external system administrators, backend engineers
- **Key Topics:**
  - Dual storage provider architecture (Replit Object Storage primary, MinIO fallback)
  - 96 storage prefixes across 11 groups with public/private classification
  - Storage Gateway API (6 endpoints: info, upload, download, signed-url, delete, list)
  - Policy engine: per-system prefix allowlists, MIME validation, size limits, operation permissions
  - External system setup (Medusa, ERPNext, Fleetbase, Temporal) with code examples
  - API key authentication flow and creation
  - Thumbnail strategy (3 pre-generated sizes + on-the-fly Next.js optimization)
  - Full URL matrix for development and production environments
  - 33 collection-to-prefix mappings
  - Troubleshooting guide
- **Dependencies:** Payload CMS cloud-storage plugin, `@google-cloud/storage`, API Keys collection

---

## 7. Assessment & Analysis Documents

### 7.1 Platform Assessment
- **File:** `ASSESSMENT.md` **(root)**
- **Purpose:** Comprehensive platform health assessment with gap analysis across all major systems. Includes AI Intelligence Layer readiness evaluation with prioritized gaps and recommendations.
- **Audience:** Technical leadership, project managers, stakeholders
- **Key Topics:**
  - Module-by-module assessment (14 modules)
  - Infrastructure health status
  - Gap identification and prioritization
  - AI Intelligence Layer assessment (16 components: 9 COMPLETE, 7 NOT BUILT)
  - AI gaps (8 items, P0-P3 priority)
  - ai-ml domain expansion (30→50 blocks)
  - Cross-Domain AI evaluation (18 blocks)
  - Recommendations (per module)
  - Priority matrix (P0-P6)
- **Dependencies:** IMPLEMENTATION_PLAN.md

---

## 8. Project Memory

### 8.1 Project Reference (replit.md)
- **File:** `replit.md`
- **Purpose:** Living project reference — maintained automatically during development sessions. Contains system architecture summary, user preferences, external dependencies, and key planning document references.
- **Audience:** AI development assistant, new team members for quick orientation
- **Key Topics:**
  - Frontend architecture (Next.js 15, Tailwind v4, 53 components)
  - Backend architecture (Payload CMS 3.74, 69 collections)
  - Domain package architecture (37 domains)
  - POI Spatial Identity Engine
  - AI Management System (existing)
  - AI Intelligence Layer (planned, 10 capabilities)
  - Storage architecture (dual provider, 96 prefixes)
  - External dependencies
  - Key planning document references

---

## Document Dependency Graph

```
DAKKAH_CITYOS_PLATFORM_BIBLE.md
  │
  ├──▶ HIERARCHICAL_DESIGN_PATTERNS.md
  ├──▶ DOMAIN_PACKAGE_ARCHITECTURE.md
  ├──▶ POI_SYSTEM_DEEP_DIVE.md
  ├──▶ ROUTES_AND_ROLES.md
  │
  ├──▶ BLOCK_USE_CASES.md
  │     │
  │     ├──▶ IMPLEMENTATION_ROADMAP.md (v2.1)
  │     │     │
  │     │     └──▶ IMPLEMENTATION_PLAN.md (checklist)
  │     │
  │     └──▶ AI_DOMAIN_DESIGN.md
  │           │
  │           ├──▶ AI_PAGE_BUILDER.md  ◀── FLAGSHIP AI DOCUMENT
  │           │
  │           └──▶ AI_ML_SYSTEM.md (existing reference)
  │
  ├──▶ ASSESSMENT.md
  │
  └──▶ DAKKAH_CITYOS_PLATFORM_GUIDE.md (plain-language synthesis of all above)
```

---

## Quick Reference: Which Document for What?

| I Need To... | Read This Document |
|-------------|-------------------|
| Understand the overall platform architecture | Platform Bible |
| Learn how multi-tenancy and hierarchies work | Hierarchical Design Patterns |
| Understand domain packages and how to build one | Domain Package Architecture |
| See what blocks exist and what needs to be built | Block Use Cases Catalog |
| Plan my sprint with phase schedules | Implementation Roadmap v2.1 |
| Check off implementation tasks | Implementation Plan (Checklist) |
| Understand the AI Page Builder in full detail | AI Page Builder |
| Learn about all 10 AI capabilities and pgvector | AI Domain Design |
| Work with the existing AI prompt/response system | AI/ML System Reference |
| Find API endpoints and role requirements | Routes and Roles Reference |
| Understand the POI/spatial system | POI System Deep Dive |
| Get a plain-language overview of everything | Platform Guide |
| Check platform health and identify gaps | Assessment |
| See what's left to build for domain packages | Domain Package Remaining Implementation |
| Understand workflow integration with Temporal | Workflow Alignment Roadmap |
| Understand commerce integration with Medusa | Commerce Team Design Note |

---

## Document Maintenance Rules

1. **replit.md** is updated every session with architecture changes
2. **BLOCK_USE_CASES.md** is updated when blocks are added/removed
3. **IMPLEMENTATION_ROADMAP.md** is updated when phase plans change
4. **ASSESSMENT.md** is updated when systems are built/fixed
5. **ROUTES_AND_ROLES.md** is updated when API routes or roles change
6. **AI_PAGE_BUILDER.md** is updated when AI composition pipeline changes
7. **All documents** must maintain consistent numbers (1,348 total blocks, 120+ API endpoints, v2.1)

---

*End of Document Index*
